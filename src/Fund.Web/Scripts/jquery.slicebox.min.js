(function(n,t,i){"use strict";var h=n.event,r,u,f,e,o,s;r=h.special.debouncedresize={setup:function(){n(this).on("resize",r.handler)},teardown:function(){n(this).off("resize",r.handler)},handler:function(n,t){var f=this,e=arguments,i=function(){n.type="debouncedresize";h.dispatch.apply(f,e)};u&&clearTimeout(u);t?i():u=setTimeout(i,r.threshold)},threshold:50};f="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";n.fn.imagesLoaded=function(t){function l(){var i=n(h),f=n(o);r&&(o.length?r.reject(u,i,f):r.resolve(u));n.isFunction(t)&&t.call(e,u,i,f)}function c(t,i){t.src!==f&&n.inArray(t,s)===-1&&(s.push(t),i?o.push(t):h.push(t),n.data(t,"imagesLoaded",{isBroken:i,src:t.src}),a&&r.notifyWith(n(t),[i,u,n(h),n(o)]),u.length===s.length&&(setTimeout(l),u.unbind(".imagesLoaded")))}var e=this,r=n.isFunction(n.Deferred)?n.Deferred():0,a=n.isFunction(r.notify),u=e.find("img").add(e.filter("img")),s=[],h=[],o=[];return n.isPlainObject(t)&&n.each(t,function(n,i){n==="callback"?t=i:r&&r[n](i)}),u.length?u.bind("load.imagesLoaded error.imagesLoaded",function(n){c(n.target,n.type==="error")}).each(function(t,r){var e=r.src,u=n.data(r,"imagesLoaded");if(u&&u.src===e){c(r,u.isBroken);return}if(r.complete&&r.naturalWidth!==i){c(r,r.naturalWidth===0||r.naturalHeight===0);return}(r.readyState||r.complete)&&(r.src=f,r.src=e)}):l(),r?r.promise(e):e};e=n(t);o=t.Modernizr;n.Slicebox=function(t,i){this.$el=n(i);this._init(t)};n.Slicebox.defaults={orientation:"v",perspective:1200,cuboidsCount:5,cuboidsRandom:!1,maxCuboidsCount:5,disperseFactor:0,colorHiddenSides:"#222",sequentialFactor:150,speed:600,easing:"ease",autoplay:!1,interval:3e3,fallbackFadeSpeed:300,onBeforeChange:function(){return!1},onAfterChange:function(){return!1},onReady:function(){return!1}};n.Slicebox.prototype={_init:function(t){if(this.options=n.extend(!0,{},n.Slicebox.defaults,t),this._validate(),this.$items=this.$el.children("li"),this.itemsCount=this.$items.length,this.itemsCount===0)return!1;this.support=o.csstransitions&&o.csstransforms3d;this.current=0;this.isAnimating=!1;this.isReady=!1;var i=this;this.$el.imagesLoaded(function(){var t=i.$items.eq(i.current).css("display","block").addClass("sb-current"),n=new Image;n.src=t.find("img").attr("src");i.realWidth=n.width;i._setSize();i._setStyle();i._initEvents();i.options.onReady();i.isReady=!0;i.options.autoplay&&i._startSlideshow()})},_validate:function(){this.options.cuboidsCount<0?this.options.cuboidsCount=1:this.options.cuboidsCount>15?this.options.cuboidsCount=15:this.options.cuboidsCount%2==0&&++this.options.cuboidsCount;this.options.maxCuboidsCount<0?this.options.maxCuboidsCount=1:this.options.maxCuboidsCount>15?this.options.maxCuboidsCount=15:this.options.maxCuboidsCount%2==0&&++this.options.maxCuboidsCount;this.options.disperseFactor<0&&(this.options.disperseFactor=0);this.options.orientation!=="v"&&this.options.orientation!=="h"&&this.options.orientation!=="r"&&(this.options.orientation="v")},_setSize:function(){var n=this.$items.eq(this.current).find("img");this.size={width:n.width(),height:n.height()}},_setStyle:function(){this.$el.css({"max-width":this.realWidth})},_initEvents:function(){var n=this;e.on("debouncedresize.slicebox",function(){n._setSize()})},_startSlideshow:function(){var n=this;this.slideshow=setTimeout(function(){n._navigate("next");n.options.autoplay&&n._startSlideshow()},this.options.interval)},_stopSlideshow:function(){this.options.autoplay&&(clearTimeout(this.slideshow),this.isPlaying=!1,this.options.autoplay=!1)},_navigate:function(n,t){if(this.isAnimating||!this.isReady||this.itemsCount<2)return!1;this.isAnimating=!0;this.prev=this.current;t!==i?this.current=t:n==="next"?this.current=this.current<this.itemsCount-1?this.current+1:0:n==="prev"&&(this.current=this.current>0?this.current-1:this.itemsCount-1);this.options.onBeforeChange(this.current);this.support?(this._layout(n),this._rotate()):this._fade(n)},_fade:function(){var t=this,i=this.$items.eq(this.prev),r=i.find("img").height();this.$el.css("height",r);this.$items.css("position","absolute");this.$items.eq(this.current).fadeIn(this.options.fallbackFadeSpeed,function(){n(this).css("display","block").addClass("sb-current");t.$el.css("height","auto");t.$items.css("position","relative");t.isAnimating=!1});t.$items.eq(t.prev).removeClass("sb-current").fadeOut(this.options.fallbackFadeSpeed)},_layout:function(t){var r=this.options.orientation,i,u;r==="r"&&(r=Math.floor(Math.random()*2)===0?"v":"h");this.options.cuboidsRandom&&(this.options.cuboidsCount=Math.floor(Math.random()*this.options.maxCuboidsCount+1));this._validate();var f={width:this.size.width,height:this.size.height,perspective:this.options.perspective+"px"},e=n.extend(this.options,{size:this.size,items:this.$items,direction:t,prev:this.prev,current:this.current,o:r}),o=this;for(this.$box=n("<div>").addClass("sb-perspective").css(f).appendTo(this.$el),this.cuboids=[],this.$el.css("overflow","visible"),i=0;i<this.options.cuboidsCount;++i)u=new n.Cuboid(e,i),this.$box.append(u.getEl()),this.cuboids.push(u)},_rotate:function(){var t,i,n;for(this.$items.eq(this.prev).removeClass("sb-current").hide(),t=0;t<this.options.cuboidsCount;++t)i=this.cuboids[t],n=this,i.rotate(function(t){if(t===n.options.cuboidsCount-1){n.$el.css("overflow","hidden");n.isAnimating=!1;n.$box.remove();var i=n.$items.eq(n.current);i.css("display","block");setTimeout(function(){i.addClass("sb-current")},0);n.options.onAfterChange(n.current)}})},_destroy:function(n){this.$el.off(".slicebox").removeData("slicebox");e.off(".slicebox");n.call()},add:function(n,t){this.$items=this.$items.add(n);this.itemsCount=this.$items.length;t&&t.call(n)},next:function(){this._stopSlideshow();this._navigate("next")},previous:function(){this._stopSlideshow();this._navigate("prev")},jump:function(n){if(n-=1,n===this.current||n>=this.itemsCount||n<0)return!1;this._stopSlideshow();this._navigate(n>this.current?"next":"prev",n)},play:function(){this.isPlaying||(this.isPlaying=!0,this._navigate("next"),this.options.autoplay=!0,this._startSlideshow())},pause:function(){this.isPlaying&&this._stopSlideshow()},isActive:function(){return this.isAnimating},destroy:function(n){this._destroy(n)}};n.Cuboid=function(n,t){this.config=n;this.pos=t;this.side=1;this._setSize();this._configureStyles()};n.Cuboid.prototype={_setSize:function(){this.size={width:this.config.o==="v"?Math.floor(this.config.size.width/this.config.cuboidsCount):this.config.size.width,height:this.config.o==="v"?this.config.size.height:Math.floor(this.config.size.height/this.config.cuboidsCount)};this.extra=this.config.o==="v"?this.config.size.width-this.size.width*this.config.cuboidsCount:this.config.size.height-this.size.height*this.config.cuboidsCount},_configureStyles:function(){var i=Math.ceil(this.config.cuboidsCount/2),r=this.pos<i?{zIndex:(this.pos+1)*100,left:this.config.o==="v"?this.size.width*this.pos:0,top:this.config.o==="v"?0:this.size.height*this.pos}:{zIndex:(this.config.cuboidsCount-this.pos)*100,left:this.config.o==="v"?this.size.width*this.pos:0,top:this.config.o==="v"?0:this.size.height*this.pos},t;this.disperseFactor=this.config.disperseFactor*(this.pos+1-i);this.style=n.extend({"-webkit-transition":"-webkit-transform "+this.config.speed+"ms "+this.config.easing,"-moz-transition":"-moz-transform "+this.config.speed+"ms "+this.config.easing,"-o-transition":"-o-transform "+this.config.speed+"ms "+this.config.easing,"-ms-transition":"-ms-transform "+this.config.speed+"ms "+this.config.easing,transition:"transform "+this.config.speed+"ms "+this.config.easing},r,this.size);this.animationStyles={side1:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px )"},side2:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px ) rotate3d( 1, 0, 0, -90deg )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px ) rotate3d( 0, 1, 0, -90deg )"},side3:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px ) rotate3d( 1, 0, 0, -180deg )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px ) rotate3d( 0, 1, 0, -180deg )"},side4:this.config.o==="v"?{transform:"translate3d( 0, 0, -"+this.size.height/2+"px ) rotate3d( 1, 0, 0, -270deg )"}:{transform:"translate3d( 0, 0, -"+this.size.width/2+"px ) rotate3d( 0, 1, 0, -270deg )"}};t=this.config.o==="v"?this.size.height:this.size.width;this.sidesStyles={frontSideStyle:{width:this.config.o==="v"?this.size.width+this.extra:this.size.width,height:this.config.o==="v"?this.size.height:this.size.height+this.extra,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 0deg ) translate3d( 0, 0, "+t/2+"px )"},backSideStyle:{width:this.size.width,height:this.size.height,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 180deg ) translate3d( 0, 0, "+t/2+"px ) rotateZ( 180deg )"},rightSideStyle:{width:t,height:this.config.o==="v"?this.size.height:this.size.height+this.extra,left:this.config.o==="v"?this.size.width/2-this.size.height/2:0,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, 90deg ) translate3d( 0, 0, "+this.size.width/2+"px )"},leftSideStyle:{width:t,height:this.config.o==="v"?this.size.height:this.size.height+this.extra,left:this.config.o==="v"?this.size.width/2-this.size.height/2:0,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 0, 1, 0, -90deg ) translate3d( 0, 0, "+this.size.width/2+"px )"},topSideStyle:{width:this.config.o==="v"?this.size.width+this.extra:this.size.width,height:t,top:this.config.o==="v"?0:this.size.height/2-this.size.width/2,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 1, 0, 0, 90deg ) translate3d( 0, 0, "+this.size.height/2+"px )"},bottomSideStyle:{width:this.config.o==="v"?this.size.width+this.extra:this.size.width,height:t,top:this.config.o==="v"?0:this.size.height/2-this.size.width/2,backgroundColor:this.config.colorHiddenSides,transform:"rotate3d( 1, 0, 0, -90deg ) translate3d( 0, 0, "+this.size.height/2+"px )"}}},getEl:function(){return this.$el=n("<div/>").css(this.style).css(this.animationStyles.side1).append(n("<div/>").addClass("sb-side").css(this.sidesStyles.frontSideStyle)).append(n("<div/>").addClass("sb-side").css(this.sidesStyles.backSideStyle)).append(n("<div/>").addClass("sb-side").css(this.sidesStyles.rightSideStyle)).append(n("<div/>").addClass("sb-side").css(this.sidesStyles.leftSideStyle)).append(n("<div/>").addClass("sb-side").css(this.sidesStyles.topSideStyle)).append(n("<div/>").addClass("sb-side").css(this.sidesStyles.bottomSideStyle)),this._showImage(this.config.prev),this.$el},_showImage:function(n){var t,r=this.config.items.eq(n),i={"background-size":this.config.size.width+"px "+this.config.size.height+"px"};i.backgroundImage="url("+r.find("img").attr("src")+")";switch(this.side){case 1:t=0;break;case 2:t=this.config.o==="v"?4:2;break;case 3:t=1;break;case 4:t=this.config.o==="v"?5:3}i.backgroundPosition=this.config.o==="v"?-(this.pos*this.size.width)+"px 0px":"0px -"+this.pos*this.size.height+"px";this.$el.children().eq(t).css(i)},rotate:function(n){var t=this,i;setTimeout(function(){if(t.config.direction==="next")switch(t.side){case 1:i=t.animationStyles.side2;t.side=2;break;case 2:i=t.animationStyles.side3;t.side=3;break;case 3:i=t.animationStyles.side4;t.side=4;break;case 4:i=t.animationStyles.side1;t.side=1}else switch(t.side){case 1:i=t.animationStyles.side4;t.side=4;break;case 2:i=t.animationStyles.side1;t.side=1;break;case 3:i=t.animationStyles.side2;t.side=2;break;case 4:i=t.animationStyles.side3;t.side=3}t._showImage(t.config.current);var r={},u={};t.config.o==="v"?(r.left="+="+t.disperseFactor+"px",u.left="-="+t.disperseFactor+"px"):t.config.o==="h"&&(r.top="+="+t.disperseFactor+"px",u.top="-="+t.disperseFactor+"px");t.$el.css(i).animate(r,t.config.speed/2).animate(u,t.config.speed/2,function(){n&&n.call(t,t.pos)})},this.config.sequentialFactor*this.pos+30)}};s=function(n){t.console&&t.console.error(n)};n.fn.slicebox=function(t){var i=n.data(this,"slicebox"),r;return typeof t=="string"?(r=Array.prototype.slice.call(arguments,1),this.each(function(){if(!i){s("cannot call methods on slicebox prior to initialization; attempted to call method '"+t+"'");return}if(!n.isFunction(i[t])||t.charAt(0)==="_"){s("no such method '"+t+"' for slicebox self");return}i[t].apply(i,r)})):this.each(function(){i?i._init():i=n.data(this,"slicebox",new n.Slicebox(t,this))}),i}})(jQuery,window);
//# sourceMappingURL=jquery.slicebox.min.js.map
